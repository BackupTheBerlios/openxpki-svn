set -e

old=`pwd`
mkdir -p /var/www/htdocs_cvs || echo /var/www/htdocs_cvs dir already present
cd /var/www/htdocs_cvs

## update CVS

svn checkout svn://svn.berlios.de/openxpki/www.openxpki.org/trunk 2>/dev/null >/dev/null
cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/openca checkout -P doc 2>/dev/null >/dev/null

## copy stuff to htdocs area

mkdir -p /var/www/htdocs
cd /var/www/htdocs/
cp -r /var/www/htdocs_cvs/www.openxpki.org/trunk/htdocs/* .
#cd docs
#mkdir howto || echo howto dir already present
#mkdir guide || echo guide dir already present
cp -r /var/www/htdocs_cvs/doc/* /var/www/htdocs/docs/
#cp -r /var/www/htdocs_cvs/openca-0.9/docs/guide/* guide/

## create symlinks if necessary
# images for One Page HTML Guide
cd docs/guide/
rm -rf images
ln -s src/images

# legacy link
rm -rf html_chunked
ln -s html html_chunked

# images for chunked html
cd html
rm -rf images
ln -s ../src/images

# css
cd /var/www/htdocs/css/

cd $old
